units           real
atom_style      full
#boundary        s s s

read_data glc_dimer_v3.data

change_box all boundary f f f
change_box all x final -50 50 y final -50 50 z final -50 50

dihedral_style fourier

# Dihedral Coeffs
# dihedral_coeff 1 3  1.080000 1 0.000000  1.380000 2 0.000000  0.960000 3 0.000000
# dihedral_coeff 2 1  0.100000 3 0.000000
# dihedral_coeff 3 15  -0.100000 1 0.000000  -0.100000 1 0.000000  -0.100000 1 0.000000  -0.100000 1 0.000000  -0.100000 1 0.000000  0.950000 2 0.000000  0.950000 2 0.000000  0.950000 2 0.000000  0.950000 2 0.000000  0.950000 2 0.000000  0.550000 3 0.000000  0.550000 3 0.000000  0.550000 3 0.000000  0.550000 3 0.000000  0.550000 3 0.000000
# dihedral_coeff 4 5  0.160000 3 0.000000  0.160000 3 0.000000  0.160000 3 0.000000  0.160000 3 0.000000  0.160000 3 0.000000
# dihedral_coeff 5 6  0.450000 1 0.000000  0.450000 1 0.000000  0.450000 1 0.000000  0.450000 1 0.000000  0.450000 1 0.000000  0.450000 1 0.000000
# dihedral_coeff 6 11  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000  0.100000 3 0.000000
# dihedral_coeff 7 3  0.160000 3 0.000000  0.160000 3 0.000000  0.160000 3 0.000000
# dihedral_coeff 8 5  -0.270000 1 0.000000  -0.270000 1 0.000000  -0.270000 1 0.000000  -0.270000 1 0.000000  -0.270000 1 0.000000
# dihedral_coeff 9 3  1.080000 1 0.000000  1.380000 2 0.000000  0.960000 3 0.000000
# dihedral_coeff 10 10  -1.100000 1 0.000000  -1.100000 1 0.000000  -1.100000 1 0.000000  -1.100000 1 0.000000  -1.100000 1 0.000000  0.250000 2 0.000000  0.250000 2 0.000000  0.250000 2 0.000000  0.250000 2 0.000000  0.250000 2 0.000000
# dihedral_coeff 11 1  0.400000 2 0.000000
# dihedral_coeff 12 3  1.080000 1 0.000000  1.380000 2 0.000000  0.960000 3 0.000000
# dihedral_coeff 13 1  -0.270000 1 0.000000
# dihedral_coeff 14 2  -1.100000 1 0.000000  0.250000 2 0.000000
# dihedral_coeff 15 1  0.180000 3 0.000000
# dihedral_coeff 16 1  0.180000 3 0.000000
# dihedral_coeff 17 1  0.180000 3 0.000000
# dihedral_coeff 18 1  0.050000 3 0.000000
# dihedral_coeff 19 2  0.270000 3 0.000000  0.270000 3 0.000000

# ここから力場定義（テスト用に極端に削る）

bond_style      none
angle_style     none
improper_style  none

pair_style      zero 10.0
pair_coeff      * *
#kspace_style    none

special_bonds lj/coul 0 0 0


# === Coeffs (coeffs.txt の内容をここに貼る) ===
# === Coeffs from coeffs.txt ===

# Pair Coeffs
#pair_coeff 1 1 0.029999999999999995 0.35635948725613575
#pair_coeff 2 2 0.07944809624565713 1.711416437757265
#pair_coeff 3 3 0.2104000002486992 3.066473387458142
#pair_coeff 4 4 0.05728874258359724 1.8780144970379664
#pair_coeff 5 5 0.15171605042039454 3.233071448539315
#pair_coeff 6 6 0.10939999991572773 3.399669508450741

# Bond Coeffs
#bond_coeff 1 553.0 0.96
#bond_coeff 2 320.0 1.43
#bond_coeff 3 285.0 1.46
#bond_coeff 4 340.0 1.09
#bond_coeff 5 310.0 1.52
#bond_coeff 6 340.0 1.09

# Angle Coeffs
#angle_coeff 1 55.0 109.50004692903693
#angle_coeff 2 100.0 112.00004800047613
#angle_coeff 3 60.0 110.00004714332478
#angle_coeff 4 70.0 107.50004607188556
#angle_coeff 5 50.0 111.60004782904585
#angle_coeff 6 45.0 111.00004757190045
#angle_coeff 7 45.0 113.50004864333965
#angle_coeff 8 60.0 110.00004714332478
#angle_coeff 9 45.0 111.00004757190045
#angle_coeff 10 70.0 108.50004650046124
#angle_coeff 11 60.0 110.00004714332478
#angle_coeff 12 60.0 110.00004714332478
#angle_coeff 13 45.0 109.50004692903693
#angle_coeff 14 100.0 112.00004800047613

# --- Dihedral energy check ---
# dihedral_write dihedral_used.txt
compute cPE all pe dihedral
thermo_style custom step c_cPE
thermo 1
# -----------------------------

# dihedral の角度をローカル配列で出力（phi を2回指定して local array を有効化）
compute dphi all dihedral/local phi phi
dump    d1 all local 1 dump.dih c_dphi[1] c_dphi[2]
run 0
